---
title: Ruff
description: Linter et formateur Python ultra-rapide écrit en Rust
navigation:
  icon: i-material-icon-theme:ruff
seo:
  title: Ruff - Linter et Formateur Python Ultra-Rapide
  description: Découvrez Ruff, le linter et formateur Python nouvelle génération écrit en Rust, offrant des performances exceptionnelles pour vos projets FastAPI et Python moderne.
---

[Ruff](https://github.com/astral-sh/ruff) est un linter et formateur de code Python extrêmement performant, développé en Rust. Il remplace avantageusement Flake8, Black, isort, pydocstyle, pyupgrade, autoflake et bien d'autres outils, tout en offrant des performances 10 à 100 fois supérieures aux solutions traditionnelles.

Ruff est particulièrement adapté aux projets FastAPI grâce à son excellent support des fonctionnalités Python modernes, des annotations de types, et sa capacité à détecter précocement les problèmes courants liés au développement d'API dans le cycle de développement.

## Pourquoi adopter Ruff ?

- **Vitesse fulgurante** : 10 à 100 fois plus rapide que les linters Python traditionnels grâce à son architecture Rust
- **Solution tout-en-un** : Combine linting, formatage et tri des imports dans un seul outil unifié
- **Python moderne** : Support complet de Python 3.8+ avec gestion avancée des type hints et des fonctionnalités récentes
- **Optimisé pour FastAPI** : Règles intégrées pour les patterns async/await et les modèles Pydantic
- **Intégration transparente** : Compatible avec les éditeurs de code, pipelines CI/CD et hooks pre-commit
- **Configuration flexible** : Personnalisation fine des règles par fichier ou par répertoire
- **Corrections automatiques** : Résolution automatique de nombreuses violations de style

## Installation

```sh
# Ajouter Ruff comme dépendance de développement
uv add --dev ruff

# Ou installer globalement avec uv
uv tool install ruff

# Installation alternative avec pip
pip install ruff

# Installation avec pipx (isolation complète)
pipx install ruff
```

## Utilisation de base

```sh
# Analyser votre code
uv run ruff check .

# Corriger automatiquement les problèmes réparables
uv run ruff check --fix .

# Formater votre code selon les standards
uv run ruff format .

# Analyse et formatage combinés (workflow recommandé)
uv run ruff check --fix . && uv run ruff format .

# Mode surveillance pour le développement
uv run ruff check --watch .

# Afficher uniquement les erreurs (ignorer les warnings)
uv run ruff check --select=E .

# Générer un rapport détaillé
uv run ruff check --output-format=json . > rapport.json
```

## Configuration avancée

Créez un fichier `ruff.toml` à la racine de votre projet ou configurez directement dans `pyproject.toml` :

```toml
# pyproject.toml
[tool.ruff]
# Version Python ciblée pour l'analyse
target-version = "py38"

# Longueur de ligne (correspond à la valeur par défaut de Black)
line-length = 88

# Répertoires à exclure de l'analyse
exclude = [
    ".git",
    ".venv",
    ".mypy_cache",
    ".pytest_cache",
    "__pycache__",
    "build",
    "dist",
    "*.egg-info",
]

# Activer le cache pour améliorer les performances
cache-dir = ".ruff_cache"

# Afficher les corrections suggérées
show-fixes = true

[tool.ruff.lint]
# Activer des ensembles de règles spécifiques
select = [
    "E",     # Erreurs pycodestyle
    "W",     # Avertissements pycodestyle
    "F",     # Pyflakes (erreurs logiques)
    "I",     # isort (tri des imports)
    "B",     # flake8-bugbear (bugs potentiels)
    "C4",    # flake8-comprehensions (optimisation des compréhensions)
    "UP",    # pyupgrade (modernisation du code)
    "ARG",   # flake8-unused-arguments (arguments non utilisés)
    "SIM",   # flake8-simplify (simplification du code)
    "ICN",   # flake8-import-conventions (conventions d'import)
    "TCH",   # flake8-type-checking (optimisation des imports de types)
    "PTH",   # flake8-use-pathlib (utilisation de pathlib)
    "PL",    # Pylint (règles de qualité)
    "RUF",   # Règles spécifiques à Ruff
]

# Désactiver certaines règles spécifiques
ignore = [
    "E501",  # Ligne trop longue (géré par le formateur)
    "B008",  # Appels de fonction dans les valeurs par défaut (utile pour FastAPI)
    "PLR0913", # Trop d'arguments dans une fonction (parfois nécessaire)
]

# Autoriser les corrections automatiques pour toutes les règles activées
fixable = ["ALL"]

# Ne jamais corriger automatiquement ces règles
unfixable = []

# Autoriser les variables non utilisées si elles commencent par un underscore
dummy-variable-rgx = "^(_+|(_+[a-zA-Z0-9_]*[a-zA-Z0-9]+?))$"

[tool.ruff.lint.per-file-ignores]
# Ignorer des règles spécifiques dans les fichiers de test
"tests/**/*.py" = [
    "S101",    # Utilisation d'assert détectée
    "ARG",     # Arguments de fonction non utilisés (fixtures)
    "FBT",     # Booléens comme arguments positionnels
    "PLR2004", # Constantes magiques dans les tests
]

# Ignorer certaines règles dans les scripts d'initialisation
"__init__.py" = [
    "F401",  # Import non utilisé (réexportation)
]

# Configuration spécifique pour les migrations de base de données
"migrations/**/*.py" = [
    "ARG001", # Arguments non utilisés
    "N806",   # Variables en minuscules
]

[tool.ruff.lint.isort]
# Configuration du tri des imports
split-on-trailing-comma = true
force-single-line = false
force-sort-within-sections = false
lines-after-imports = 2

# Ordre des sections d'imports
section-order = [
    "future",
    "standard-library",
    "third-party",
    "first-party",
    "local-folder",
]

# Imports connus comme first-party
known-first-party = ["app", "core", "api"]

[tool.ruff.lint.mccabe]
# Complexité cyclomatique maximale (McCabe)
max-complexity = 10

[tool.ruff.lint.pydocstyle]
# Convention de docstrings (Google, NumPy ou PEP257)
convention = "google"

[tool.ruff.format]
# Utiliser des guillemets doubles pour les chaînes
quote-style = "double"

# Indentation avec 4 espaces
indent-style = "space"

# Style de fin de ligne
line-ending = "auto"

# Préserver les citations de docstrings
docstring-code-format = true
```

### Règles spécifiques pour FastAPI

Ruff inclut plusieurs règles particulièrement utiles pour le développement FastAPI :

```toml
[tool.ruff.lint]
select = [
    "ASYNC",  # Bonnes pratiques async/await
    "FAST",   # Règles spécifiques FastAPI (détection des dépendances incorrectes)
    "TRIO",   # Bonnes pratiques pour le code asynchrone
    "RUF006", # Détection des mutations de valeurs par défaut
]

# Exemple de règles pour les projets FastAPI
[tool.ruff.lint.per-file-ignores]
"app/api/**/*.py" = [
    "B008",  # Autoriser les appels de fonction dans les défauts (Depends(), Body(), etc.)
]
```

## Intégration avec VS Code

Installez l'[extension Ruff](https://marketplace.visualstudio.com/items?itemName=charliermarsh.ruff) et ajoutez à votre `settings.json` :

```json
{
    "[python]": {
        "editor.defaultFormatter": "charliermarsh.ruff",
        "editor.formatOnSave": true,
        "editor.codeActionsOnSave": {
            "source.fixAll.ruff": "explicit",
            "source.organizeImports.ruff": "explicit"
        }
    },
    "ruff.lint.args": ["--config=pyproject.toml"],
    "ruff.format.args": ["--config=pyproject.toml"],
    "ruff.enable": true,
    "ruff.organizeImports": true
}
```

### Intégration avec PyCharm / IntelliJ

1. Installez le plugin Ruff depuis le marketplace
2. Configurez les outils externes dans `Settings > Tools > External Tools`
3. Ajoutez Ruff comme formateur externe

### Hooks Pre-commit

Ajoutez à `.pre-commit-config.yaml` pour automatiser les vérifications avant chaque commit :

```yaml
repos:
  - repo: https://github.com/astral-sh/ruff-pre-commit
    # Version recommandée - vérifiez la dernière version disponible
    rev: v0.6.0
    hooks:
      # Exécuter le linter avec corrections automatiques
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]
      # Exécuter le formateur
      - id: ruff-format

# Configuration optionnelle pour exécuter les hooks en parallèle
default_install_hook_types: [pre-commit, pre-push]
```

Installation des hooks :

```sh
# Installer pre-commit si nécessaire
pip install pre-commit

# Installer les hooks dans votre repository
pre-commit install

# Exécuter manuellement sur tous les fichiers
pre-commit run --all-files
```

## Workflows courants

```sh
# Vérification complète de la qualité du code
uv run ruff check --fix .
uv run ruff format .

# Vérification sans modifications (mode dry-run)
uv run ruff check .
uv run ruff format --check .

# Exécution sur des fichiers spécifiques
uv run ruff check app/main.py app/models/

# Exécution avec configuration personnalisée
uv run ruff check --config=custom-ruff.toml .

# Générer et afficher la configuration active
uv run ruff check --show-settings

# Obtenir des explications sur une règle spécifique
uv run ruff rule F401
uv run ruff rule --all  # Lister toutes les règles

# Afficher les statistiques de violations
uv run ruff check --statistics .

# Mode différentiel (analyser uniquement les fichiers modifiés)
uv run ruff check $(git diff --name-only --diff-filter=ACM | grep '\.py$')

# Ignorer temporairement le cache
uv run ruff check --no-cache .

# Exporter la configuration au format JSON
uv run ruff check --show-settings --output-format=json > config.json
```

## Intégration CI/CD

### GitHub Actions

```yaml
# .github/workflows/quality.yml
name: Qualité du Code
on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  lint:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ["3.9", "3.10", "3.11", "3.12"]
    
    steps:
      - name: Checkout du code
        uses: actions/checkout@v4
      
      - name: Installation de uv
        uses: astral-sh/setup-uv@v3
        with:
          enable-cache: true
      
      - name: Installation de Python ${{ matrix.python-version }}
        run: uv python install ${{ matrix.python-version }}
      
      - name: Installation des dépendances
        run: uv sync --dev --all-extras
      
      - name: Vérification avec Ruff (linting)
        run: uv run ruff check . --output-format=github
      
      - name: Vérification du formatage
        run: uv run ruff format --check .
      
      - name: Génération du rapport
        if: always()
        run: |
          uv run ruff check . --output-format=json > ruff-report.json
      
      - name: Upload du rapport
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: ruff-report-${{ matrix.python-version }}
          path: ruff-report.json
```

### GitLab CI

```yaml
# .gitlab-ci.yml
ruff-lint:
  stage: test
  image: python:3.11
  before_script:
    - pip install uv
    - uv sync --dev
  script:
    - uv run ruff check .
    - uv run ruff format --check .
  artifacts:
    reports:
      codequality: ruff-report.json
  rules:
    - if: $CI_MERGE_REQUEST_ID
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH
```

### Jenkins Pipeline

```groovy
pipeline {
    agent any
    
    stages {
        stage('Quality Check') {
            steps {
                sh 'uv sync --dev'
                sh 'uv run ruff check . || true'
                sh 'uv run ruff format --check .'
            }
        }
    }
    
    post {
        always {
            recordIssues(tools: [pyLint(pattern: '**/ruff-report.json')])
        }
    }
}
```

## Commandes avancées et astuces

```sh
# Activer le mode verbeux pour le débogage
uv run ruff check --verbose .

# Désactiver spécifiquement certaines règles pour une exécution
uv run ruff check --ignore=E501,W503 .

# Activer uniquement certaines règles
uv run ruff check --select=F,E .

# Afficher les performances de l'analyse
uv run ruff check --timing .

# Utiliser des patterns d'exclusion avancés
uv run ruff check --exclude='**/migrations/*,**/tests/fixtures/*' .

# Générer une configuration de base
uv run ruff check --generate-config > ruff.toml

# Mode de compatibilité avec d'autres outils
uv run ruff check --output-format=pylint .
uv run ruff check --output-format=junit > junit.xml
```

## Optimisation des performances

Pour les grands projets, considérez ces optimisations :

```toml
[tool.ruff]
# Activer le cache (activé par défaut)
cache-dir = ".ruff_cache"

# Limiter la profondeur de recherche
respect-gitignore = true

# Utiliser des workers parallèles
# (automatique, mais peut être ajusté)
```

```sh
# Exécution parallèle sur plusieurs cœurs
RAYON_NUM_THREADS=8 uv run ruff check .

# Analyse incrémentale (uniquement les fichiers modifiés)
uv run ruff check --diff $(git diff --name-only HEAD)
```

## Migration depuis d'autres outils

Ruff facilite la migration depuis les outils traditionnels :

```sh
# Générer une configuration équivalente depuis flake8
ruff config --flake8-to-ruff .flake8

# Comparer les résultats avec Black
ruff format --diff .

# Vérifier la compatibilité isort
ruff check --select=I --diff .
```

## Ressources complémentaires

- [Documentation officielle](https://docs.astral.sh/ruff/)
- [Liste complète des règles](https://docs.astral.sh/ruff/rules/)
- [Guide de migration](https://docs.astral.sh/ruff/migration/)
- [Intégrations éditeurs](https://docs.astral.sh/ruff/integrations/)
- [Comparaison de performances](https://github.com/astral-sh/ruff#benchmarks)
